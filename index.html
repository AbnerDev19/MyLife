<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Notion - Gamificado</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="fotos/mY.png">
</head>

<body>
    <div id="sync-status" class="sync-status text-sm">
        <i class="ri-loader-4-line spin"></i> Conectando ao Banco de Dados...
    </div>

    <div class="app-layout">
        <aside class="sidebar">
            <div class="profile-section">
                <div class="avatar-container">
                    <img src="https://ui-avatars.com/api/?name=Neo+Player&background=f1f1ef&color=37352f&size=128" class="avatar" alt="Avatar">
                </div>
                <div class="profile-info">
                    <h2 id="global-name">Abner üòä</h2>
                    <p class="text-sub" id="global-level-text">Lvl 1 ‚Ä¢ XP: 0</p>
                </div>
            </div>

            <nav class="sidebar-menu">
                <button class="menu-item active" onclick="switchView('dashboard')" id="nav-dashboard">
                    <i class="ri-dashboard-line"></i> Dashboard
                </button>
                <button class="menu-item" onclick="switchView('study')" id="nav-study">
                    <i class="ri-book-read-line"></i> Sala de Estudos
                </button>
            </nav>

            <div class="sidebar-block">
                <div class="flex-between text-sm mb-1">
                    <span class="font-medium">Progresso do N√≠vel</span>
                    <span id="xp-display" class="text-sub">0 / 1000</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill xp-fill" id="xp-bar" style="width: 0%"></div>
                </div>
            </div>

            <div class="sidebar-block">
                <h3 class="sidebar-title">Estat√≠sticas de Hoje</h3>
                <ul class="stats-list">
                    <li>
                        <i class="ri-arrow-up-circle-line text-blue"></i>
                        <span>XP Ganho:</span>
                        <strong id="today-xp" style="margin-left: auto;">0</strong>
                    </li>
                    <li>
                        <i class="ri-check-line text-green"></i>
                        <span>Metas Di√°rias:</span>
                        <strong id="today-goals" style="margin-left: auto;">0/0</strong>
                    </li>
                </ul>
            </div>

            <div class="sidebar-block">
                <div class="flex-between mb-1" style="align-items: center;">
                    <h3 class="sidebar-title" style="margin:0;">Meus Atributos</h3>
                    <button class="icon-btn" id="btn-open-attr" title="Novo Atributo"><i class="ri-add-line"></i></button>
                </div>
                <div id="attributes-container" style="display: flex; flex-direction: column; gap: 12px; margin-top: 8px;">
                </div>
            </div>

            <div class="sidebar-block history-block">
                <div class="flex-between mb-1" style="align-items: center;">
                    <h3 class="sidebar-title" style="margin:0;">Hist√≥rico Recente</h3>
                    <button class="icon-btn" id="btn-clear-history" title="Limpar Hist√≥rico"><i class="ri-delete-bin-line"></i></button>
                </div>
                <ul class="history-list" id="history-container">
                </ul>
            </div>
        </aside>

        <main class="main-content">
            
            <div id="view-dashboard" class="view-section active">
                <header class="page-header">
                    <h1 contenteditable="true" class="page-title" spellcheck="false">Meu Dashboard</h1>
                    <p id="daily-quote" class="page-description">"A evolu√ß√£o acontece todos os dias."</p>
                </header>

                <div class="quick-actions">
                    <button class="action-btn" id="btn-open-task"><i class="ri-add-line"></i> Nova Miss√£o</button>
                    <button class="action-btn" id="btn-open-habit"><i class="ri-add-line"></i> Novo H√°bito</button>
                    <button class="action-btn" id="btn-open-activity"><i class="ri-timer-line"></i> Nova Atividade</button>
                    <button class="action-btn" id="btn-open-study"><i class="ri-add-circle-line"></i> Inserir Tempo Manual</button>
                    <button class="action-btn" id="btn-open-log"><i class="ri-edit-line"></i> Registrar A√ß√£o</button>
                </div>

                <section class="content-section">
                    <div class="section-header">
                        <h2><i class="ri-timer-flash-line"></i> Atividades (Com Prazo)</h2>
                    </div>
                    <div class="tasks-list" id="activities-container"></div>
                </section>

                <section class="content-section">
                    <div class="section-header">
                        <h2><i class="ri-checkbox-multiple-line"></i> Miss√µes do Dia</h2>
                        <span id="task-progress-text" class="text-sub text-sm">0% Conclu√≠do</span>
                    </div>
                    <div class="progress-track mb-3">
                        <div class="progress-fill blue-fill" id="day-progress-bar" style="width: 0%"></div>
                    </div>
                    <div class="tasks-list" id="tasks-container"></div>
                </section>

                <section class="content-section">
                    <div class="section-header">
                        <h2><i class="ri-loop-left-line"></i> H√°bitos Di√°rios</h2>
                    </div>
                    <div class="habits-list" id="habits-container"></div>
                </section>
            </div>

            <div id="view-study" class="view-section">
                <header class="page-header">
                    <h1 class="page-title">Sala de Estudos</h1>
                    <p class="page-description">Foque no aprendizado. O tempo estudado gera XP autom√°tico!</p>
                </header>

                <div class="study-stats-grid">
                    <div class="study-card">
                        <h4>Sequ√™ncia de Estudos</h4>
                        <div class="big-number"><span id="streak-count" class="text-orange">0</span> Dias Seguidos</div>
                        <div class="streak-days" id="streak-days-container">
                            </div>
                    </div>
                    <div class="study-card">
                        <h4>Tempo Total Estudado</h4>
                        <div class="big-number" id="total-study-time">0h 0m</div>
                        <p class="text-sub text-sm mt-1">Sua dedica√ß√£o acumulada.</p>
                    </div>
                </div>

                <div class="study-controls-header flex-between mb-3">
                    <div class="study-goal-box">
                        <span class="text-sm text-sub">Meta Di√°ria:</span>
                        <strong id="daily-study-goal-display">0h 0m</strong>
                        <button class="icon-btn" id="btn-edit-study-goal" title="Editar Meta"><i class="ri-pencil-line"></i></button>
                    </div>
                    <div class="streak-multiplier">
                        <span class="text-sm font-medium"><i class="ri-fire-fill text-yellow"></i> Ofensiva: <span id="streak-multiplier-text">1.0x XP</span></span>
                    </div>
                </div>

                <div class="timer-box">
                    <div class="timer-tabs">
                        <button class="timer-tab active" id="tab-stopwatch">Cron√¥metro</button>
                        <button class="timer-tab" id="tab-countdown">Temporizador</button>
                    </div>

                    <div class="subject-selector-group mb-3">
                        <select id="timer-subject-select" class="notion-input" style="max-width: 250px; display: inline-block;">
                            <option value="" disabled selected>Selecione a mat√©ria...</option>
                        </select>
                        <button class="action-btn" id="btn-new-subject" style="display: inline-flex; padding: 4px 8px; margin-left: 8px;"><i class="ri-add-line"></i> Nova Mat√©ria</button>
                    </div>

                    <div id="countdown-setup" style="display: none; margin-bottom: 16px;">
                        <input type="number" id="countdown-input-minutes" class="notion-input" placeholder="Minutos (ex: 25)" style="max-width: 120px; text-align: center;">
                    </div>

                    <div class="timer-display" id="timer-display">00:00:00</div>
                    <p class="text-sub text-sm" id="timer-xp-hint">Ganha 1 XP (+ b√¥nus de ofensiva) por minuto.</p>
                    
                    <div class="timer-controls">
                        <button class="timer-btn btn-play" id="btn-timer-play" title="Iniciar"><i class="ri-play-fill"></i></button>
                        <button class="timer-btn btn-pause" id="btn-timer-pause" title="Pausar"><i class="ri-pause-fill"></i></button>
                        <button class="timer-btn btn-stop" id="btn-timer-stop" title="Finalizar e Salvar"><i class="ri-stop-fill"></i></button>
                    </div>
                </div>
                <section class="content-section">
                    <div class="section-header">
                        <h2><i class="ri-bar-chart-box-line"></i> Desempenho por Disciplina (Minutos)</h2>
                    </div>
                    <div style="position: relative; height: 300px; width: 100%; background: var(--bg-main); border: 1px solid var(--border-color); border-radius: var(--radius-lg); padding: 16px;">
                        <canvas id="studyChart"></canvas>
                    </div>
                </section>
            </div>

        </main>
    </div>

    <div id="modal-attr" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Novo Atributo (Skill)</h3>
            <p class="text-sub text-sm mb-3">Crie um atributo para evoluir (ex: Programa√ß√£o, Sa√∫de, Leitura).</p>
            <div class="input-group">
                <input type="text" id="input-attr-name" class="notion-input" placeholder="Nome do atributo..." autocomplete="off">
                <span class="error-msg" id="error-attr-name"></span>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-attr">Cancelar</button>
                <button class="btn-primary" id="save-attr">Criar Atributo</button>
            </div>
        </div>
    </div>
    
    <div id="modal-task" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Criar Miss√£o</h3>
            <div class="input-group">
                <input type="text" id="input-task-name" class="notion-input" placeholder="Nome da tarefa..." autocomplete="off">
                <span class="error-msg" id="error-task-name"></span>
            </div>
            <div class="input-group">
                <input type="number" id="input-task-xp" class="notion-input" placeholder="Recompensa de XP (Ex: 50)" min="1">
                <span class="error-msg" id="error-task-xp"></span>
            </div>
            <div class="input-group">
                <select id="input-task-attr" class="notion-input">
                    </select>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-task">Cancelar</button>
                <button class="btn-primary" id="save-task">Adicionar</button>
            </div>
        </div>
    </div>

    <div id="modal-habit" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Novo H√°bito</h3>
            <div class="input-group">
                <input type="text" id="input-habit-name" class="notion-input" placeholder="Nome do h√°bito..." autocomplete="off">
                <span class="error-msg" id="error-habit-name"></span>
            </div>
            <div class="input-group">
                <select id="input-habit-attr" class="notion-input">
                    </select>
                <p class="text-sub text-sm mt-1">Ganha 10 XP por check.</p>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-habit">Cancelar</button>
                <button class="btn-primary" id="save-habit">Adicionar</button>
            </div>
        </div>
    </div>

    <div id="modal-activity" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Nova Atividade com Prazo</h3>
            <div class="input-group">
                <input type="text" id="input-act-name" class="notion-input" placeholder="Nome da atividade..." autocomplete="off">
                <span class="error-msg" id="error-act-name"></span>
            </div>
            <div class="input-group">
                <label class="text-sub text-sm" style="display:block; margin-bottom:4px;">Prazo de Entrega:</label>
                <input type="datetime-local" id="input-act-date" class="notion-input">
                <span class="error-msg" id="error-act-date"></span>
            </div>
            <div class="input-group">
                <select id="input-act-diff" class="notion-input">
                    <option value="" disabled selected>N√≠vel de Dificuldade</option>
                    <option value="easy">F√°cil (30 XP)</option>
                    <option value="medium">M√©dio (60 XP)</option>
                    <option value="hard">Dif√≠cil (100 XP)</option>
                </select>
                <span class="error-msg" id="error-act-diff"></span>
            </div>
            <div class="input-group">
                <select id="input-act-attr" class="notion-input">
                    </select>
            </div>
            <p class="text-sub text-sm" style="color: var(--red);">* Atrasos resultam em perda do XP correspondente.</p>
            <div class="modal-actions">
                <button class="btn-cancel close-activity">Cancelar</button>
                <button class="btn-primary" id="save-activity">Adicionar</button>
            </div>
        </div>
    </div>

    <div id="modal-log" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Registro Manual</h3>
            <div class="input-group">
                <input type="text" id="input-log-desc" class="notion-input" placeholder="O que voc√™ fez agora?" autocomplete="off">
                <span class="error-msg" id="error-log-desc"></span>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-log">Cancelar</button>
                <button class="btn-primary" id="save-log">Registrar</button>
            </div>
        </div>
    </div>

    <div id="modal-study" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Adicionar Tempo Manual</h3>
            <div class="input-group">
                <input type="text" id="input-study-subject" class="notion-input" placeholder="Mat√©ria (ex: Programa√ß√£o, Ingl√™s)..." autocomplete="off">
                <span class="error-msg" id="error-study-subject"></span>
            </div>
            <div class="input-group">
                <input type="number" id="input-study-time" class="notion-input" placeholder="Tempo estudado (em minutos)" min="1">
                <span class="error-msg" id="error-study-time"></span>
                <p class="text-sub text-sm mt-1">Ganha 1 XP por cada minuto estudado!</p>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-study">Cancelar</button>
                <button class="btn-primary" id="save-study">Registrar Estudo</button>
            </div>
        </div>
    </div>

    <div id="modal-subject" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Nova Mat√©ria</h3>
            <div class="input-group">
                <input type="text" id="input-subject-name" class="notion-input" placeholder="Nome da mat√©ria..." autocomplete="off">
                <span class="error-msg" id="error-subject-name"></span>
            </div>
            <div class="input-group">
                <label class="text-sub text-sm mb-1" style="display:block;">Cor da Tag:</label>
                <input type="color" id="input-subject-color" value="#2383e2" style="width: 100%; height: 40px; border: none; cursor: pointer;">
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-subject">Cancelar</button>
                <button class="btn-primary" id="save-subject">Criar</button>
            </div>
        </div>
    </div>

    <div id="modal-study-goal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Meta Di√°ria de Estudo</h3>
            <div class="input-group">
                <input type="number" id="input-study-goal" class="notion-input" placeholder="Minutos por dia (ex: 120)" min="1">
                <span class="error-msg" id="error-study-goal"></span>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel close-study-goal">Cancelar</button>
                <button class="btn-primary" id="save-study-goal">Salvar Meta</button>
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>

</html>